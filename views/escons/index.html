<style media="screen">
    svg .seat {
        cursor: pointer;
        transition: all 500ms;
    }

    /* Colors dels partits */
    svg .seat.cs { fill:#FA7515 }
    svg .seat.jxc { fill: #FF5B9C }
    svg .seat.erc { fill: #F8BC4B }
    svg .seat.psc { fill: #C8001E }
    svg .seat.com { fill: #701471 }
    svg .seat.cup { fill: #F6E134 }
    svg .seat.pp { fill: #4F92E1 }
    svg .seat.pacma { fill: #BAC02E }
    svg .seat.recortes { fill: #4B873E }
    svg .seat.pumj { fill: #48BFE9 }
    svg .seat.dialeg { fill: #999999 }

    /* common */
    svg .seat.vacant { fill: #FFFFFF }
    svg .seat.no-party { fill: #909090; }

    /* tooltip */
    div.tooltip {
      position: absolute;
      text-align: center;
      /*width: 80px;*/
      /*height: 25px;*/
      padding: 2px;
      font: 14px sans-serif;
      color: white;
      background: grey;
      border: 0px;
      border-radius: 8px;
      pointer-events: none;
    }
</style>
<div ng-controller="esconsController">
    <!-- Alerts -->
    <uib-alert ng-repeat="alert in alerts" type="{{alert.type}}" close="closeAlert($index)">{{alert.msg}}</uib-alert>
    <h2 class="page-header">
      Repartiment d'escons
      <div class="pull-right">
          <img ng-hide="loadingimage == null" ng-src="{{loadingimage}}" width="16px" height="16px" style="margin:none;">
          <small><span style="color:red;">Resultats provisionals</span></small>
      </div>
    </h2>
    <div class="row">
      <div class="col-sm-8" style="padding-top: 60px; padding-right: 100px; padding-bottom: 60px; padding-left: 100px;">
        <svg id="chart"></svg>
        <script type="text/javascript">
          // Define the div for the tooltip
          var div = d3.select("body").append("div")
          .attr("class", "tooltip")
          .style("opacity", 0);

          var width = window.innerWidth/2;
          var height = window.innerWidth/2;

          var draw = function () {
            var parliament = d3.parliament().width(width).height(height).innerRadiusCoef(0.4);
            parliament.enter.fromCenter(true).smallToBig(true);
            parliament.exit.toCenter(true).bigToSmall(true);
            /*parliament.on("click", function(e) { console.log(e); });*/
            parliament.on("mouseover", function(d) {
              div.transition()
                  .duration(200)
                  .style("opacity", .9);
              div	.html(d.party.name)
                  .style("left", (d3.event.pageX) + "px")
                  .style("top", (d3.event.pageY - 28) + "px");
            });
            parliament.on("mouseout", function(d) {
              div.transition()
                  .duration(500)
                  .style("opacity", 0);
            });
            var setData = function(d) {
                d3.select("svg").datum(d).call(parliament);
            };
            d3.json("/data/escons.json", setData);
          }

          // Responsive
          d3.select(window)
            .on("resize", function() {
              width = window.innerWidth/2;
              height = window.innerWidth/2;
              draw();
            });

          draw();
        </script>
      </div>
      <div class="col-sm-4">
        <table class="table table-striped">
          <thead>
            <tr>
              <th style="width: 10px">Color</th>
              <th>Partit</th>
              <th>Escons</th>
            </tr>
          </thead>
          <tbody>
            <tr ng-repeat="partit in escons">
              <td bgcolor="{{partit.colour}}"></td>
              <td>{{ partit.name }}</td>
              <td>{{ partit.seats }}</td>
            </tr>
          </tbody>
        </table>
      </div>
    </div>
</div>
